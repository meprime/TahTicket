{% extends 'general_template.html' %}

{% block header_extension %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static "form_style.css" %}">
{% endblock %}

{% block main_content %}
    <div class="arriv">
    <div class="container">
        <div id="error_message" style="text-align: center"></div>
        <form role="form" class="col-md-4 col-md-offset-4 sign_form" id="email_form" method="post">
            {% csrf_token %}
                <div class="form-group">
                    <label for="email">
آدرس پست الکترونیکی‌تان:
                    </label>
                    <input type="email" class="form-control" id="email">
                </div>
            <button type="submit" class="btn btn-primary" id="pass_reset">
                رمز عبورم را تجدید کن
            </button>
        </form>
        <div class="col-md-4 col-md-offset-4">
            <div><a style="color: #0083C9" href="/">
                بازگشت به خانه
            </a></div>
        </div>

    </div>
    </div>

<script>
    var button = document.getElementById('pass_reset');
    button.onclick = function(event) {
        event.preventDefault();
        var email = document.querySelector("#email").value;
        var m = validate_email(email);
        if(m != null) {
            event.preventDefault();
            var t = document.createTextNode(m);
            document.querySelector("#error_message").appendChild(t);
            document.querySelector("#error_message").style.color = 'red';
        }
        else {
            window.alert('به‌زودی رمز عبور جدیدتان برایتان فرستاده خواهد شد');
            document.getElementById('email_form').submit();
        }

        /*var d = document.createElement('div');
        var mess = document.createTextNode('We\'ll soon send you a password-reset email.');
        d.appendChild(mess);
        d.style.color = "Green";
        var fm = document.getElementById('final_message');
        fm.appendChild(d);*/
    }

    function validate_email(email) {
        var re = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if(!re.test(email))
            return "آدرس ایملیتان معتبر نیست";
    }

</script>
{% endblock %}